<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>6-Week Adaptive Fitness Tracker</title>
<style>
body { font-family: Arial, sans-serif; padding:20px; max-width:700px; margin:auto; background:#f5f5f5; }
h1,h2,h3{text-align:center;}
.section{background:#fff;padding:15px;margin:10px 0;border-radius:8px;box-shadow:0 0 5px rgba(0,0,0,0.1);}
button{padding:8px 12px;margin:5px 2px;cursor:pointer;}
input[type=number]{width:60px;}
img{border-radius:5px;cursor:pointer;}
.feedback{color:green;font-weight:bold;}
.debt{color:red;font-weight:bold;}
</style>
</head>
<body>

<h1>6-Week Adaptive Fitness Tracker</h1>

<div class="section">
<h2>Day <span id="dayNumber">1</span> Workout</h2>
<p id="workloadInfo"></p>
<p>Pushups: <span id="pushups">0</span> reps × <span id="pushupsSets">0</span> sets <span id="pushupsDebt"></span></p>
<p>Squats: <span id="squats">0</span> reps × <span id="squatsSets">0</span> sets <span id="squatsDebt"></span></p>
<p>Abs/Core:</p>
<ul>
<li>Plank: <span id="plank">0</span> sec × <span id="plankSets">0</span> sets <span id="plankDebt"></span></li>
<li>Sit-ups: <span id="situps">0</span> reps × <span id="situpsSets">0</span> sets <span id="situpsDebt"></span></li>
<li>Leg Raises: <span id="legraises">0</span> reps × <span id="legraisesSets">0</span> sets <span id="legraisesDebt"></span></li>
</ul>
<p>Run: <span id="runKm">0</span> km <span id="runDebt"></span></p>
</div>

<div class="section">
<h3>Exercise Guide (Click images)</h3>
<div style="display:flex;flex-wrap:wrap;gap:10px;">
  <div>
    <img src="https://i.imgur.com/9Qp1xkF.png" alt="Pushups" width="80" onclick="showExercise('pushups')">
    <p>Pushups</p>
  </div>
  <div>
    <img src="https://i.imgur.com/fkX0rI7.png" alt="Squats" width="80" onclick="showExercise('squats')">
    <p>Squats</p>
  </div>
  <div>
    <img src="https://i.imgur.com/M8XxgYc.png" alt="Plank" width="80" onclick="showExercise('plank')">
    <p>Plank</p>
  </div>
  <div>
    <img src="https://i.imgur.com/ohYZq7V.png" alt="Sit-ups" width="80" onclick="showExercise('situps')">
    <p>Sit-ups</p>
  </div>
  <div>
    <img src="https://i.imgur.com/8S2Z4oe.png" alt="Leg Raises" width="80" onclick="showExercise('legraises')">
    <p>Leg Raises</p>
  </div>
  <div>
    <img src="https://i.imgur.com/UXyS2qB.png" alt="Run" width="80" onclick="showExercise('run')">
    <p>Run</p>
  </div>
</div>
</div>

<div class="section">
<h3>Log Exercise</h3>

<!-- Pushups -->
<label>Pushups done: 
  <input type="number" id="pushupsDoneSets" placeholder="sets"> × 
  <input type="number" id="pushupsDoneReps" placeholder="reps">
</label>
<button onclick="logExercise('pushups')">Log</button><br>

<!-- Squats -->
<label>Squats done: 
  <input type="number" id="squatsDoneSets" placeholder="sets"> × 
  <input type="number" id="squatsDoneReps" placeholder="reps">
</label>
<button onclick="logExercise('squats')">Log</button><br>

<!-- Plank -->
<label>Plank done (sec): 
  <input type="number" id="plankDoneSets" placeholder="sets"> × 
  <input type="number" id="plankDoneSec" placeholder="sec">
</label>
<button onclick="logExercise('plank')">Log</button><br>

<!-- Sit-ups -->
<label>Sit-ups done: 
  <input type="number" id="situpsDoneSets" placeholder="sets"> × 
  <input type="number" id="situpsDoneReps" placeholder="reps">
</label>
<button onclick="logExercise('situps')">Log</button><br>

<!-- Leg Raises -->
<label>Leg Raises done: 
  <input type="number" id="legraisesDoneSets" placeholder="sets"> × 
  <input type="number" id="legraisesDoneReps" placeholder="reps">
</label>
<button onclick="logExercise('legraises')">Log</button><br>

<!-- Run -->
<label>Run done (km): <input type="number" id="runDone" step="0.1" placeholder="km"></label>
<button onclick="logRun()">Log</button><br>
<p id="runFeedback"></p>
</div>

<div class="section">
<h3>Log Meals</h3>
<p>Breakfast:</p>
<button onclick="logMeal('breakfast','clean')">Clean</button>
<button onclick="logMeal('breakfast','normal')">Normal</button>
<button onclick="logMeal('breakfast','bad')">Bad</button>

<p>Lunch:</p>
<button onclick="logMeal('lunch','clean')">Clean</button>
<button onclick="logMeal('lunch','normal')">Normal</button>
<button onclick="logMeal('lunch','bad')">Bad</button>

<p>Dinner:</p>
<button onclick="logMeal('dinner','clean')">Clean</button>
<button onclick="logMeal('dinner','normal')">Normal</button>
<button onclick="logMeal('dinner','bad')">Bad</button>

<p>Snacks:</p>
<button onclick="logMeal('snack','clean')">Healthy</button>
<button onclick="logMeal('snack','normal')">Normal</button>
<button onclick="logMeal('snack','bad')">Junk</button>
</div>

<div class="section">
<h3>Daily Info</h3>
<p id="loadScoreDisplay"></p>
<p id="carryOverDisplay"></p>
</div>

<div class="section">
<button onclick="undoLast()">Undo Last Log</button>
<button onclick="restDay()">Rest Day</button>
<button onclick="nextDay()">Next Day</button>
</div>

<!-- Exercise Popup -->
<div id="exerciseModal" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);align-items:center;justify-content:center;">
<div style="background:#fff;padding:20px;border-radius:10px;max-width:400px;text-align:center;position:relative;">
<span style="position:absolute;top:10px;right:15px;cursor:pointer;font-size:20px;" onclick="closeModal()">×</span>
<h3 id="modalTitle"></h3>
<p id="modalText"></p>
</div>
</div>

<script>
// --- Stats & tracking ---
let loadScore = parseInt(localStorage.getItem("loadScore")) || 58;
let debt = JSON.parse(localStorage.getItem("debt")) || {pushups:0,squats:0,plank:0,situps:0,legraises:0,run:0};
let carryOver = parseInt(localStorage.getItem("carryOver")) || 0;
let dayCount = parseInt(localStorage.getItem("dayCount")) || 1;
let workoutPlan = {};
let lastLog = null; // store last action

// --- Weekly progression ---
const weeklyProgress = [
{push:12,squat:15,plank:45,sit:20,leg:15,run:2.0},
{push:13,squat:16,plank:50,sit:22,leg:16,run:2.2},
{push:14,squat:17,plank:55,sit:24,leg:17,run:2.5},
{push:15,squat:18,plank:60,sit:25,leg:18,run:2.8},
{push:16,squat:19,plank:65,sit:26,leg:19,run:3.0},
{push:17,squat:20,plank:70,sit:27,leg:20,run:3.2}
];

// --- Generate daily workout ---
function generateWorkout(){
  document.getElementById("dayNumber").innerText = dayCount;
  let weekIndex = Math.floor((dayCount-1)/7);
  let base = weeklyProgress[Math.min(weekIndex,weeklyProgress.length-1)];
  let setFactor = Math.max(1,Math.round(base.push/5));

  workoutPlan = {
    pushups: base.push, pushupsSets: setFactor,
    squats: base.squat, squatsSets: setFactor,
    plank: base.plank, plankSets: setFactor,
    situps: base.sit, situpsSets: setFactor,
    legraises: base.leg, legraisesSets: setFactor,
    runKm: base.run + debt.run*0.2
  };

  ["pushups","squats","plank","situps","legraises"].forEach(ex=>{
    document.getElementById(ex).innerText = workoutPlan[ex];
    document.getElementById(ex+"Sets").innerText = workoutPlan[ex+"Sets"];
    document.getElementById(ex+"Debt").innerHTML = debt[ex]>0?`<span class="debt">(+${debt[ex]} debt)</span>`:`<span class="feedback">All good</span>`;
  });
  document.getElementById("runKm").innerText = workoutPlan.runKm.toFixed(1);
  document.getElementById("runDebt").innerHTML = debt.run>0?`<span class="debt">(+${debt.run.toFixed(1)} km debt)</span>`:`<span class="feedback">All good</span>`;
  
  document.getElementById("workloadInfo").innerText = `Load Score: ${loadScore}`;
  document.getElementById("loadScoreDisplay").innerText = `Current Load Score: ${loadScore}`;
  document.getElementById("carryOverDisplay").innerText = `Carry Over: ${carryOver}`;
}

// --- Log flexible sets×reps ---
function logExercise(name){
  let setsInput = parseFloat(document.getElementById(name+"DoneSets").value)||0;
  let repsInput = parseFloat((document.getElementById(name+"DoneReps")||document.getElementById(name+"DoneSec")).value||0);
  let totalDone = setsInput * repsInput;
  let plannedTotal = workoutPlan[name+"Sets"] * workoutPlan[name];

  lastLog = {type:"exercise", name, totalDone, plannedTotal, prevDebt: debt[name]};

  if(totalDone < plannedTotal){ debt[name] += (plannedTotal - totalDone);}
  else { debt[name] = Math.max(0, debt[name] - (totalDone - plannedTotal));}
  localStorage.setItem("debt",JSON.stringify(debt));

  document.getElementById(name+"DoneSets").value = '';
  if(document.getElementById(name+"DoneReps")) document.getElementById(name+"DoneReps").value = '';
  if(document.getElementById(name+"DoneSec")) document.getElementById(name+"DoneSec").value = '';

  generateWorkout();
}

// --- Run ---
function logRun(){
  let km = parseFloat(document.getElementById("runDone").value)||0;
  let planned = workoutPlan.runKm;

  lastLog = {type:"run", totalDone: km, prevDebt: debt.run};

  if(km < planned){ debt.run += (planned - km)*2; }
  else { debt.run = Math.max(0,debt.run - (km - planned)); }
  localStorage.setItem("debt",JSON.stringify(debt));
  document.getElementById("runDone").value = '';
  document.getElementById("runFeedback").innerText = `Ran ${km} km. Debt updated.`;
  generateWorkout();
}

// --- Meals ---
function logMeal(meal,type){
  let change = 0;
  if(type==="clean") change = 2;
  if(type==="normal") change = 0;
  if(type==="bad") change = (meal==="snack")?-3:-5;
  loadScore += change;
  loadScore = Math.max(0,Math.min(100,loadScore));
  localStorage.setItem("loadScore",loadScore);
  generateWorkout();
  alert(`${meal} logged as ${type}. LoadScore change: ${change}`);
}

// --- Next day ---
function nextDay(){
  dayCount++;
  localStorage.setItem("dayCount",dayCount);
  let totalWorkout = workoutPlan.pushups + workoutPlan.squats + workoutPlan.plank + workoutPlan.situps + workoutPlan.legraises + workoutPlan.runKm*10;
  let remaining = Math.max(0,totalWorkout - loadScore);
  carryOver = Math.round(remaining*0.8);
  localStorage.setItem("carryOver",carryOver);
  generateWorkout();
  lastLog = null;
  alert(`Next day generated! Carry over: ${carryOver}`);
}

// --- Undo last action ---
function undoLast(){
  if(!lastLog){ alert("No action to undo!"); return; }
  if(lastLog.type==="exercise"){ debt[lastLog.name] = lastLog.prevDebt; }
  if(lastLog.type==="run"){ debt.run = lastLog.prevDebt; }
  localStorage.setItem("debt", JSON.stringify(debt));
  lastLog = null;
  generateWorkout();
  alert("Last action undone!");
}

// --- Rest day ---
function restDay(){
  alert("Rest day: no exercises logged. Move to next day.");
  nextDay();
}

// --- Popups ---
function showExercise(ex){
  let sets = workoutPlan[ex+"Sets"];
  let reps = workoutPlan[ex];
  let unit = (ex==="plank")?"sec":"reps";
  document.getElementById("modalTitle").innerText = ex.charAt(0).toUpperCase()+ex.slice(1);
  document.getElementById("modalText").innerText = `${sets} sets × ${reps} ${unit}\nFollow proper form and control.`;
  document.getElementById("exerciseModal").style.display = "flex";
}
function closeModal(){document.getElementById("exerciseModal").style.display = "none";}

// --- Init ---
generateWorkout();
</script>
</body>
</html>
