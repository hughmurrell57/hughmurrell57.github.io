<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Adaptive Workout Tracker</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; max-width: 500px; margin:auto; background:#f5f5f5; }
  h1, h2, h3 { text-align:center; }
  .section { background:#fff; padding:15px; margin:10px 0; border-radius:8px; box-shadow:0 0 5px rgba(0,0,0,0.1);}
  button { padding:8px 12px; margin:5px 2px; }
  input[type=number] { width:70px; }
</style>
</head>
<body>

<h1>Adaptive Workout Tracker</h1>
<h2>Day Tracker</h2>

<div class="section">
  <h3>Today's Workload</h3>
  <p id="workloadInfo"></p>
  <p>Pushups: <span id="pushups">0</span></p>
  <p>Squats: <span id="squats">0</span></p>
  <p>Core (sec): <span id="core">0</span></p>
  <p>Run (km): <span id="runKm">0</span></p>
</div>

<div class="section">
  <h3>Log Exercise</h3>
  <label>Pushups done: <input type="number" id="pushDone" step="1"></label>
  <button onclick="logExercise('pushups')">Log</button>
  <button onclick="skipExercise('pushups')">Skipped</button><br>

  <label>Squats done: <input type="number" id="squatDone" step="1"></label>
  <button onclick="logExercise('squats')">Log</button>
  <button onclick="skipExercise('squats')">Skipped</button><br>

  <label>Core done (sec): <input type="number" id="coreDone" step="1"></label>
  <button onclick="logExercise('core')">Log</button>
  <button onclick="skipExercise('core')">Skipped</button><br>

  <label>Run done (km): <input type="number" id="runDone" step="0.1"></label>
  <button onclick="logRun()">Log</button>
  <button onclick="skipRun()">Skipped</button><br>
  <p id="runFeedback"></p>
</div>

<div class="section">
  <h3>Log Dinner</h3>
  <button onclick="logDinner('clean')">Clean</button>
  <button onclick="logDinner('normal')">Normal</button>
  <button onclick="logDinner('bad')">Bad</button>
</div>

<div class="section">
  <h3>Daily Info</h3>
  <p id="loadScoreDisplay"></p>
  <p id="carryOverDisplay"></p>
</div>

<div class="section">
  <button onclick="nextDay()">Next Day</button>
</div>

<script>
let loadScore = parseInt(localStorage.getItem("loadScore")) || 58;
let debt = JSON.parse(localStorage.getItem("debt")) || {pushups:0,squats:0,core:0,run:0};
let carryOver = parseInt(localStorage.getItem("carryOver")) || 0;
let workoutPlan = {};

function generateWorkout() {
  const base = loadScore;
  workoutPlan = {
    pushups: Math.round(base*0.5 + debt.pushups*0.3),
    squats: Math.round(base*1.1 + debt.squats*0.3),
    core: Math.round(base*0.35 + debt.core*0.3),
    runKm: ((base/15) + debt.run*0.2)
  };
  document.getElementById("pushups").innerText = workoutPlan.pushups;
  document.getElementById("squats").innerText = workoutPlan.squats;
  document.getElementById("core").innerText = workoutPlan.core;
  document.getElementById("runKm").innerText = workoutPlan.runKm.toFixed(1);
  document.getElementById("workloadInfo").innerText = `Load Score: ${loadScore}`;
  document.getElementById("loadScoreDisplay").innerText = `Current Load Score: ${loadScore}`;
  document.getElementById("carryOverDisplay").innerText = `Carry Over: ${carryOver}`;
}

function logExercise(name) {
  let done = parseFloat(document.getElementById(name + "Done").value) || 0;
  let planned = workoutPlan[name];
  if(done < planned){
    debt[name] += (planned - done);
  } else {
    debt[name] = Math.max(0, debt[name] - (done - planned));
  }
  localStorage.setItem("debt", JSON.stringify(debt));
  generateWorkout();
}

function skipExercise(name){
  let planned = workoutPlan[name];
  debt[name] += planned;
  localStorage.setItem("debt", JSON.stringify(debt));
  generateWorkout();
}

function logRun(){
  let km = parseFloat(document.getElementById("runDone").value) || 0;
  let planned = workoutPlan.runKm;
  if(km < planned){
    debt.run += (planned - km)*2;
  } else {
    debt.run = Math.max(0, debt.run - (km - planned));
  }
  localStorage.setItem("debt", JSON.stringify(debt));
  document.getElementById("runFeedback").innerText = `Ran ${km} km. Run debt: ${debt.run.toFixed(1)}`;
  generateWorkout();
}

function skipRun(){
  debt.run += workoutPlan.runKm*2.5;
  localStorage.setItem("debt", JSON.stringify(debt));
  document.getElementById("runFeedback").innerText = `Run skipped. Heavy run debt added.`;
  generateWorkout();
}

function logDinner(type){
  if(type==="clean") loadScore += 2;
  if(type==="normal") loadScore += 0;
  if(type==="bad") loadScore -= 5;
  loadScore = Math.max(0, Math.min(100, loadScore));
  localStorage.setItem("loadScore", loadScore);
  generateWorkout();
}

function nextDay(){
  let totalWorkout = workoutPlan.pushups + workoutPlan.squats + workoutPlan.core + workoutPlan.runKm*10;
  let remaining = Math.max(0, totalWorkout - (loadScore));
  carryOver = Math.round(remaining*0.8);
  localStorage.setItem("carryOver", carryOver);
  generateWorkout();
  alert("Next day generated! Carry over: "+carryOver);
}

generateWorkout();
</script>
</body>
</html>
